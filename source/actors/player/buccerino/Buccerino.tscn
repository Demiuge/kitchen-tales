[gd_scene load_steps=11 format=2]

[ext_resource path="res://actors/player/PlayerCombatActor.tscn" type="PackedScene" id=1]
[ext_resource path="res://actors/combat/Combo.tscn" type="PackedScene" id=2]
[ext_resource path="res://actors/combat/Attack.tscn" type="PackedScene" id=3]
[ext_resource path="res://actors/combat/HitBox.tscn" type="PackedScene" id=4]
[ext_resource path="res://actors/player/buccerino/PigCharacter.tscn" type="PackedScene" id=5]
[ext_resource path="res://utility/DebugPanel.tscn" type="PackedScene" id=6]

[sub_resource type="RectangleShape2D" id=1]
extents = Vector2( 48, 40 )

[sub_resource type="Animation" id=2]
resource_name = "cut"
length = 0.2
step = 0.05
tracks/0/type = "value"
tracks/0/path = NodePath("CombatStateMachine/IdleState/AttackRight/Cut/HitBox/CollisionShape2D:disabled")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0.05, 0.2 ),
"transitions": PoolRealArray( 1, 1 ),
"update": 1,
"values": [ false, true ]
}
tracks/1/type = "method"
tracks/1/path = NodePath("CombatStateMachine/IdleState/AttackRight/Cut/HitBox")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0.05, 0.2 ),
"transitions": PoolRealArray( 1, 1 ),
"values": [ {
"args": [  ],
"method": "enable"
}, {
"args": [  ],
"method": "disable"
} ]
}
tracks/2/type = "method"
tracks/2/path = NodePath("CombatStateMachine/IdleState/AttackRight/Cut")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PoolRealArray( 0.2 ),
"transitions": PoolRealArray( 1 ),
"values": [ {
"args": [  ],
"method": "start_cooldown"
} ]
}
tracks/3/type = "value"
tracks/3/path = NodePath("AttackAnimator:playback_speed")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ 1.0 ]
}

[sub_resource type="Animation" id=4]
resource_name = "dice"
length = 0.4
step = 0.01
tracks/0/type = "value"
tracks/0/path = NodePath("CombatStateMachine/IdleState/AttackRight/Dice/HitBox/CollisionShape2D:disabled")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0.3, 0.32, 0.34, 0.36, 0.38, 0.4 ),
"transitions": PoolRealArray( 1, 1, 1, 1, 1, 1 ),
"update": 1,
"values": [ false, true, false, true, false, true ]
}
tracks/1/type = "method"
tracks/1/path = NodePath("CombatStateMachine/IdleState/AttackRight/Dice/HitBox")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0.3, 0.32, 0.34, 0.36, 0.38, 0.4 ),
"transitions": PoolRealArray( 1, 1, 1, 1, 1, 1 ),
"values": [ {
"args": [  ],
"method": "enable"
}, {
"args": [  ],
"method": "disable"
}, {
"args": [  ],
"method": "enable"
}, {
"args": [  ],
"method": "disable"
}, {
"args": [  ],
"method": "enable"
}, {
"args": [  ],
"method": "disable"
} ]
}
tracks/2/type = "method"
tracks/2/path = NodePath("CombatStateMachine/IdleState/AttackRight/Dice")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PoolRealArray( 0.4 ),
"transitions": PoolRealArray( 1 ),
"values": [ {
"args": [  ],
"method": "start_cooldown"
} ]
}
tracks/3/type = "value"
tracks/3/path = NodePath("AttackAnimator:playback_speed")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ 0.75 ]
}

[sub_resource type="Animation" id=3]
resource_name = "slice"
length = 0.25
step = 0.05
tracks/0/type = "value"
tracks/0/path = NodePath("CombatStateMachine/IdleState/AttackRight/Slice/HitBox/CollisionShape2D:disabled")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/keys = {
"times": PoolRealArray( 0.1, 0.15, 0.2, 0.25 ),
"transitions": PoolRealArray( 1, 1, 1, 1 ),
"update": 1,
"values": [ false, true, false, true ]
}
tracks/1/type = "method"
tracks/1/path = NodePath("CombatStateMachine/IdleState/AttackRight/Slice/HitBox")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/keys = {
"times": PoolRealArray( 0.1, 0.15, 0.2, 0.25 ),
"transitions": PoolRealArray( 1, 1, 1, 1 ),
"values": [ {
"args": [  ],
"method": "enable"
}, {
"args": [  ],
"method": "disable"
}, {
"args": [  ],
"method": "enable"
}, {
"args": [  ],
"method": "disable"
} ]
}
tracks/2/type = "method"
tracks/2/path = NodePath("CombatStateMachine/IdleState/AttackRight/Slice")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/keys = {
"times": PoolRealArray( 0.25 ),
"transitions": PoolRealArray( 1 ),
"values": [ {
"args": [  ],
"method": "start_cooldown"
} ]
}
tracks/3/type = "value"
tracks/3/path = NodePath("AttackAnimator:playback_speed")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/keys = {
"times": PoolRealArray( 0 ),
"transitions": PoolRealArray( 1 ),
"update": 0,
"values": [ 1.0 ]
}

[node name="Buccerino" instance=ExtResource( 1 )]

[node name="StateMachine" parent="." index="2"]
editor/display_folded = true

[node name="Move" parent="StateMachine/IdleState" index="0"]
actor_path = NodePath("../../../../Buccerino/StateMachine/IdleState")

[node name="Jump" parent="StateMachine/IdleState" index="1"]
actor_path = NodePath("../../../../Buccerino/StateMachine/IdleState")

[node name="Fall" parent="StateMachine/IdleState" index="3"]
actor_path = NodePath("../../../../Buccerino/StateMachine/IdleState")

[node name="Dash" parent="StateMachine/IdleState" index="4"]
actor_path = NodePath("../../../../Buccerino/StateMachine/IdleState")

[node name="Stop" parent="StateMachine/WalkState" index="0"]
actor_path = NodePath("../../../../Buccerino/StateMachine/WalkState")

[node name="Jump" parent="StateMachine/WalkState" index="1"]
actor_path = NodePath("../../../../Buccerino/StateMachine/WalkState")

[node name="Move" parent="StateMachine/WalkState" index="2"]
actor_path = NodePath("../../../../Buccerino/StateMachine/WalkState")

[node name="Fall" parent="StateMachine/WalkState" index="4"]
actor_path = NodePath("../../../../Buccerino/StateMachine/WalkState")

[node name="Dash" parent="StateMachine/WalkState" index="5"]
actor_path = NodePath("../../../../Buccerino/StateMachine/WalkState")

[node name="Jump" parent="StateMachine/JumpState" index="0"]
actor_path = NodePath("../../../../Buccerino/StateMachine/JumpState")

[node name="Fall" parent="StateMachine/JumpState" index="1"]
actor_path = NodePath("../../../../Buccerino/StateMachine/JumpState")

[node name="Stop" parent="StateMachine/JumpState" index="2"]
actor_path = NodePath("../../../../Buccerino/StateMachine/JumpState")

[node name="Move" parent="StateMachine/JumpState" index="3"]
actor_path = NodePath("../../../../Buccerino/StateMachine/JumpState")

[node name="Dash" parent="StateMachine/JumpState" index="5"]
actor_path = NodePath("../../../../Buccerino/StateMachine/JumpState")

[node name="Stop" parent="StateMachine/DashState" index="0"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashState")

[node name="Bump" parent="StateMachine/DashState" index="1"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashState")

[node name="DistanceStop" parent="StateMachine/DashState" index="2"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashState")

[node name="Jump" parent="StateMachine/DashState" index="3"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashState")

[node name="Fall" parent="StateMachine/DashJumpState" index="0"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashJumpState")

[node name="Stop" parent="StateMachine/DashJumpState" index="1"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashJumpState")

[node name="Move" parent="StateMachine/DashJumpState" index="2"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashJumpState")

[node name="Fall" parent="StateMachine/SecondJumpState" index="0"]
actor_path = NodePath("../../../../Buccerino/StateMachine/SecondJumpState")

[node name="Stop" parent="StateMachine/SecondJumpState" index="1"]
actor_path = NodePath("../../../../Buccerino/StateMachine/SecondJumpState")

[node name="Move" parent="StateMachine/SecondJumpState" index="2"]
actor_path = NodePath("../../../../Buccerino/StateMachine/SecondJumpState")

[node name="Stop" parent="StateMachine/DashJumpFallState" index="0"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashJumpFallState")

[node name="Move" parent="StateMachine/DashJumpFallState" index="2"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashJumpFallState")

[node name="Fall" parent="StateMachine/DashJumpFallState" index="3"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashJumpFallState")

[node name="Gravity" parent="StateMachine/SingleFallState" index="4"]
actor_path = NodePath("../../../../Buccerino")

[node name="Stop" parent="StateMachine/DashFallState" index="0"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashFallState")

[node name="Move" parent="StateMachine/DashFallState" index="2"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashFallState")

[node name="Fall" parent="StateMachine/DashFallState" index="3"]
actor_path = NodePath("../../../../Buccerino/StateMachine/DashFallState")

[node name="Gravity" parent="StateMachine/SecondFallState" index="3"]
actor_path = NodePath("../../../../Buccerino")

[node name="DuckState" parent="StateMachine" index="10"]
editor/display_folded = true

[node name="Controls" parent="." index="3"]
editor/display_folded = true

[node name="CombatStateMachine" parent="." index="4"]
actor_path = NodePath("../../Buccerino")

[node name="AttackRight" parent="CombatStateMachine/IdleState" index="0" instance=ExtResource( 2 )]
position = Vector2( 104, -64 )

[node name="Cut" parent="CombatStateMachine/IdleState/AttackRight" index="0" instance=ExtResource( 3 )]
visible = false

[node name="HitBox" parent="CombatStateMachine/IdleState/AttackRight/Cut" index="1" instance=ExtResource( 4 )]

[node name="CollisionShape2D" type="CollisionShape2D" parent="CombatStateMachine/IdleState/AttackRight/Cut/HitBox" index="0"]
shape = SubResource( 1 )
disabled = true

[node name="Slice" parent="CombatStateMachine/IdleState/AttackRight" index="1" instance=ExtResource( 3 )]
visible = false

[node name="HitBox" parent="CombatStateMachine/IdleState/AttackRight/Slice" index="1" instance=ExtResource( 4 )]

[node name="CollisionShape2D" type="CollisionShape2D" parent="CombatStateMachine/IdleState/AttackRight/Slice/HitBox" index="0"]
shape = SubResource( 1 )

[node name="Dice" parent="CombatStateMachine/IdleState/AttackRight" index="2" instance=ExtResource( 3 )]

[node name="HitBox" parent="CombatStateMachine/IdleState/AttackRight/Dice" index="1" instance=ExtResource( 4 )]

[node name="CollisionShape2D" type="CollisionShape2D" parent="CombatStateMachine/IdleState/AttackRight/Dice/HitBox" index="0"]
shape = SubResource( 1 )

[node name="HurtBox" parent="." index="5"]
editor/display_folded = true

[node name="PickupArea" parent="." index="7"]
editor/display_folded = true

[node name="Pig" parent="." index="8" instance=ExtResource( 5 )]

[node name="Debug" type="CanvasLayer" parent="." index="9"]

[node name="DebugPanel" parent="Debug" index="0" instance=ExtResource( 6 )]
reference_path = NodePath("../../StateMachine")
properties = PoolStringArray( "previous_state_name", "current_state_name" )

[node name="AttackAnimator" type="AnimationPlayer" parent="." index="10"]
playback_speed = 0.75
anims/cut = SubResource( 2 )
anims/dice = SubResource( 4 )
anims/slice = SubResource( 3 )
[connection signal="entered" from="StateMachine/IdleState" to="Pig" method="play" binds= [ "idle" ]]
[connection signal="entered" from="StateMachine/WalkState" to="Pig" method="play" binds= [ "walk" ]]
[connection signal="entered" from="StateMachine/JumpState" to="Pig" method="play" binds= [ "jump" ]]
[connection signal="entered" from="StateMachine/DashState" to="Pig" method="play" binds= [ "dash" ]]
[connection signal="entered" from="StateMachine/DashJumpState" to="Pig" method="play" binds= [ "dash" ]]
[connection signal="entered" from="StateMachine/SecondJumpState" to="Pig" method="play" binds= [ "jump" ]]
[connection signal="entered" from="StateMachine/DashJumpFallState" to="Pig" method="play" binds= [ "fall" ]]
[connection signal="entered" from="StateMachine/SingleFallState" to="Pig" method="play" binds= [ "fall" ]]
[connection signal="entered" from="StateMachine/DashFallState" to="Pig" method="play" binds= [ "fall" ]]
[connection signal="entered" from="StateMachine/SecondFallState" to="Pig" method="play" binds= [ "fall" ]]
[connection signal="entered" from="StateMachine/DuckState" to="Pig" method="play" binds= [ "duck" ]]
[connection signal="pressed" from="Controls/LeftAction" to="Pig" method="set_look_direction" binds= [ -1 ]]
[connection signal="pressed" from="Controls/RightAction" to="Pig" method="set_look_direction" binds= [ 1 ]]
[connection signal="finished" from="CombatStateMachine/IdleState/AttackRight/Cut" to="AttackAnimator" method="stop"]
[connection signal="finished" from="CombatStateMachine/IdleState/AttackRight/Cut" to="Pig" method="play" binds= [ "idle" ]]
[connection signal="started" from="CombatStateMachine/IdleState/AttackRight/Cut" to="AttackAnimator" method="play" binds= [ "cut" ]]
[connection signal="started" from="CombatStateMachine/IdleState/AttackRight/Cut" to="Pig" method="play" binds= [ "cut" ]]
[connection signal="finished" from="CombatStateMachine/IdleState/AttackRight/Slice" to="AttackAnimator" method="stop"]
[connection signal="finished" from="CombatStateMachine/IdleState/AttackRight/Slice" to="Pig" method="play" binds= [ "idle" ]]
[connection signal="started" from="CombatStateMachine/IdleState/AttackRight/Slice" to="AttackAnimator" method="play" binds= [ "slice" ]]
[connection signal="started" from="CombatStateMachine/IdleState/AttackRight/Slice" to="Pig" method="play" binds= [ "slice" ]]
[connection signal="finished" from="CombatStateMachine/IdleState/AttackRight/Dice" to="AttackAnimator" method="stop"]
[connection signal="finished" from="CombatStateMachine/IdleState/AttackRight/Dice" to="Pig" method="play" binds= [ "idle" ]]
[connection signal="started" from="CombatStateMachine/IdleState/AttackRight/Dice" to="AttackAnimator" method="play" binds= [ "dice" ]]
[connection signal="started" from="CombatStateMachine/IdleState/AttackRight/Dice" to="Pig" method="play" binds= [ "dice" ]]
